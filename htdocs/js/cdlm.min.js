(function(){jQuery(function(t){"use strict";var i,n;return i=function(){function i(t,i){this.videoList=[],this.index=i||this.rankMax,this.country=t,this.player="",this.init=!0}return i.prototype.rankMax=50,i.prototype.play=function(i,n){var e,s,r;for(n&&(this.index=n);!this.videoList[this.index]||!this.videoList[this.index].video;)if("prev"===i){if(this.index>=this.rankMax)return;++this.index}else{if(1>=this.index)return;--this.index}return this.init||this.player.loadVideoById(this.videoList[this.index].video.id),e='<div class="track">\n<span class="rank">'+this.videoList[this.index].rank+'&nbsp</span>\n<span class="info">'+this.videoList[this.index].info.artist.name+"&nbsp/&nbsp"+this.videoList[this.index].info.name+"</span><br />",this.videoList[this.index].video&&(e+='<span class="video_info">('+this.videoList[this.index].video.title+")</span>",t("title").text(this.videoList[this.index].video.title)),e+="</div>",t("#current").html(e),this.videoList[this.index].rank>1?(s=this.index-1,r="",this.videoList[s].video&&(r+='<div id="next_img"><img src="'+this.videoList[s].video.thumbnail.sqDefault+'" width="120" height="90" /></div>\n<div class="next_track">\n<span class="rank">'+this.videoList[s].rank+'&nbsp</span>\n<span class="info">'+this.videoList[s].info.artist.name+"&nbsp/&nbsp"+this.videoList[s].info.name+'</span><br />\n<span class="video_info">('+this.videoList[s].video.title+")</span>\n</div>"),t("#next_song").html(r)):t("#next_song").html(""),this.highlight(),history.replaceState(null,"CDLM "+this.country+":"+this.index,"/track/"+this.country+"/"+this.index)},i.prototype.next=function(){return 1>=this.index?void 0:(--this.index,this.play("next"))},i.prototype.prev=function(){return this.index>=this.rankMax?void 0:(++this.index,this.play("prev"))},i.prototype.highlight=function(){return t("#list").children().css("color","black"),t("#trac_"+this.videoList[this.index].rank).css("color","red")},i.prototype.getList=function(){var i=this;return t.getJSON("/track/"+this.country+".json",{},function(n){var e,s,r,a,o,d,h,c;for(s="",r=!1,c=n.reverse(),d=0,h=c.length;h>d;d++)o=c[d],i.videoList[o.rank]=o,s+='<div id="trac_'+o.rank+'" class="track">\n<span class="rank">'+o.rank+'&nbsp</span>\n<span class="info">'+o.info.artist.name+"&nbsp;/&nbsp;"+o.info.name+"</span><br />",o.video&&(s+='<span class="video_info">('+o.video.title+')</span>\n<input type="button" id="button_trac_'+o.rank+'" value="play" class="play_button" />',!r&&i.index&&(i.index=o.rank,r=!0)),s+="</div>";return t("#list").html(s),i.highlight(),t(".play_button").click(function(n){var e;return e=t(n.target).attr("id"),e=e.replace(/button_trac_/,""),i.play("next",e)}),a=document.createElement("script"),a.src="//www.youtube.com/iframe_api",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(a,e),window.onYouTubeIframeAPIReady=function(){return i.player=new YT.Player("video",{height:"425",width:"760",videoId:i.videoList[i.index].video.id,events:{onStateChange:function(t){var n;return n=t.data,n===YT.PlayerState.ENDED?i.next():void 0},onError:function(){return this.next()}}})},i.play("next"),i.init=!1})},i}(),n=new i(t("meta[name=country]").attr("content"),t("meta[name=rank]").attr("content")),n.getList(),t("#prev").click(function(){return n.prev()}),t("#next").click(function(){return n.next()}),t("#show").click(function(){return window.show()}),t("#content").tabs()})}).call(this);